# Frontend Developer Guide

**Location:** `/frontend/`  
**Framework:** React 19  
**Build Tool:** Vite  
**UI Library:** shadcn/ui  
**Styling:** Tailwind CSS 4  
**Package Manager:** Bun

---

## Project Structure

```
frontend/
├── src/
│   ├── pages/              # Page components
│   ├── components/         # Reusable UI components
│   ├── lib/                # Utility functions
│   ├── hooks/              # Custom React hooks
│   ├── App.tsx             # Main router
│   ├── main.tsx            # Entry point
│   └── index.css            # Global styles
├── public/                 # Static assets
├── client.ts               # Auto-generated API client (DO NOT EDIT)
├── vite.config.ts          # Vite configuration
├── tsconfig.json           # TypeScript config
├── package.json            # Dependencies
└── index.html              # HTML template
```

---

## Key Rule: API Client

### Important
**`client.ts` is auto-generated by Encore - NEVER edit it manually**

This file is automatically generated during the Encore build process and contains all API endpoints from the backend.

### How to Use It
```typescript
// ✅ Good - Use the generated client
import client from "@/client";

const result = await client.verification.verify({
  serialNumber: "ABC123",
  manufacturer: "Apple",
});

// ❌ Bad - Direct fetch calls
const result = await fetch("/api/verify", { /* ... */ });

// ❌ Bad - Editing client.ts
// Never modify this file!
```

---

## Creating Pages

### Page Structure
Each page should be in `/src/pages/` and represent a route.

```typescript
// File: src/pages/VerificationPage.tsx
import { useState } from "react";
import client from "@/client";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";

export default function VerificationPage() {
  const [serialNumber, setSerialNumber] = useState("");
  const [result, setResult] = useState(null);
  const [loading, setLoading] = useState(false);

  const handleVerify = async () => {
    setLoading(true);
    try {
      const response = await client.verification.verify({
        serialNumber,
      });
      setResult(response);
    } catch (error) {
      console.error("Verification failed:", error);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="container mx-auto p-4">
      <h1 className="text-3xl font-bold mb-4">Device Verification</h1>

      <div className="space-y-4">
        <Input
          placeholder="Enter serial number"
          value={serialNumber}
          onChange={(e) => setSerialNumber(e.target.value)}
        />

        <Button
          onClick={handleVerify}
          disabled={loading}
        >
          {loading ? "Verifying..." : "Verify"}
        </Button>

        {result && (
          <div className="mt-4 p-4 bg-green-50 border border-green-200 rounded">
            <p>Verification Result: {result.verified ? "Valid" : "Invalid"}</p>
          </div>
        )}
      </div>
    </div>
  );
}
```

### Page Routing
Add your page to `App.tsx`:

```typescript
// src/App.tsx
import { BrowserRouter, Routes, Route } from "react-router-dom";
import VerificationPage from "./pages/VerificationPage";
import DashboardPage from "./pages/DashboardPage";

export default function App() {
  return (
    <BrowserRouter>
      <Routes>
        <Route path="/" element={<VerificationPage />} />
        <Route path="/dashboard" element={<DashboardPage />} />
      </Routes>
    </BrowserRouter>
  );
}
```

---

## Creating Components

### Component Best Practices
```typescript
// ✅ Good - Single responsibility
export function DeviceCard({ device }: { device: Device }) {
  return (
    <div className="p-4 border rounded">
      <h3 className="font-bold">{device.model}</h3>
      <p className="text-sm text-gray-600">{device.serialNumber}</p>
    </div>
  );
}

// ✅ Good - Reusable
export function TrustScoreBadge({ score }: { score: number }) {
  const color = score > 80 ? "green" : score > 50 ? "yellow" : "red";
  return (
    <span className={`px-3 py-1 rounded-full bg-${color}-100 text-${color}-800`}>
      {score}%
    </span>
  );
}

// ❌ Bad - Too much logic
export function VerificationPage() {
  // Form logic + API calls + result display + analytics
  // Too many responsibilities!
}
```

### Using shadcn/ui Components
```typescript
import { Button } from "@/components/ui/button";
import { Card } from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { Dialog } from "@/components/ui/dialog";
import { Badge } from "@/components/ui/badge";

export function MyComponent() {
  return (
    <Card className="p-4">
      <h2 className="text-xl font-bold mb-4">My Card</h2>
      <Input placeholder="Enter something" />
      <Button className="mt-4">Submit</Button>
    </Card>
  );
}
```

---

## State Management

### Local State (useState)
```typescript
// For component-specific state
const [isOpen, setIsOpen] = useState(false);
const [formData, setFormData] = useState({ name: "", email: "" });
```

### Shared State (Context)
```typescript
// Create context
const UserContext = createContext();

// Provider
export function UserProvider({ children }) {
  const [user, setUser] = useState(null);

  return (
    <UserContext.Provider value={{ user, setUser }}>
      {children}
    </UserContext.Provider>
  );
}

// Use context
export function useUser() {
  return useContext(UserContext);
}

// In component
export function MyComponent() {
  const { user } = useUser();
  return <div>Hello {user?.name}</div>;
}
```

### API State (React Query Pattern)
```typescript
// ✅ Good - Fetch and cache
export function useDevice(serialNumber: string) {
  const [device, setDevice] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  useEffect(() => {
    if (!serialNumber) return;

    setLoading(true);
    client.verification
      .getDevice({ serialNumber })
      .then(setDevice)
      .catch(setError)
      .finally(() => setLoading(false));
  }, [serialNumber]);

  return { device, loading, error };
}

// Use it
export function DeviceViewer({ serialNumber }: { serialNumber: string }) {
  const { device, loading, error } = useDevice(serialNumber);

  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error.message}</div>;
  if (!device) return <div>Not found</div>;

  return <DeviceCard device={device} />;
}
```

---

## Styling with Tailwind

### Basic Styling
```typescript
// ✅ Good - Use Tailwind utilities
<div className="p-4 bg-white border border-gray-200 rounded-lg shadow">
  <h2 className="text-xl font-bold text-gray-900">Title</h2>
  <p className="text-sm text-gray-600 mt-2">Description</p>
</div>

// ❌ Bad - Custom CSS when Tailwind exists
<div style={{ padding: "16px", backgroundColor: "white", borderRadius: "8px" }}>
  ...
</div>
```

### Responsive Design
```typescript
// ✅ Good - Mobile-first
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
  {/* Stacks on mobile, 2 columns on tablet, 3 on desktop */}
</div>

// ✅ Good - Hide/show based on screen
<div className="hidden md:block">
  {/* Only visible on medium screens and up */}
</div>
```

### Dark Mode
```typescript
// ✅ Good - Support dark mode
<div className="bg-white dark:bg-gray-900 text-gray-900 dark:text-white">
  Content
</div>
```

---

## API Integration

### Calling Backend Endpoints
```typescript
import client from "@/client";

// GET request
const device = await client.verification.getDevice({
  id: "123",
});

// POST request
const result = await client.verification.verify({
  serialNumber: "ABC123",
  manufacturer: "Apple",
});

// Error handling
try {
  const result = await client.verification.verify(data);
} catch (error) {
  console.error("Verification failed:", error.message);
  // Show error to user
}
```

### Loading States
```typescript
export function VerificationForm() {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  const handleSubmit = async (data) => {
    setLoading(true);
    setError(null);

    try {
      const result = await client.verification.verify(data);
      // Handle success
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      {error && <div className="text-red-600">{error}</div>}
      <button disabled={loading}>
        {loading ? "Loading..." : "Submit"}
      </button>
    </form>
  );
}
```

---

## Forms

### Using React Hook Form
```typescript
import { useForm } from "react-hook-form";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";

export function VerificationForm() {
  const { register, handleSubmit, formState: { errors } } = useForm();

  const onSubmit = async (data) => {
    const result = await client.verification.verify(data);
    console.log(result);
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)}>
      <Input
        {...register("serialNumber", { required: "Serial number is required" })}
        placeholder="Serial number"
      />
      {errors.serialNumber && (
        <span className="text-red-600">{errors.serialNumber.message}</span>
      )}

      <Input
        {...register("manufacturer", { required: true })}
        placeholder="Manufacturer"
      />

      <Button type="submit">Verify</Button>
    </form>
  );
}
```

---

## Custom Hooks

### Creating Custom Hooks
```typescript
// File: src/hooks/useVerification.ts
import { useState, useCallback } from "react";
import client from "@/client";

export function useVerification() {
  const [result, setResult] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);

  const verify = useCallback(async (data) => {
    setLoading(true);
    setError(null);

    try {
      const response = await client.verification.verify(data);
      setResult(response);
      return response;
    } catch (err) {
      setError(err.message);
      throw err;
    } finally {
      setLoading(false);
    }
  }, []);

  return { verify, result, loading, error };
}

// Usage
export function MyComponent() {
  const { verify, result, loading, error } = useVerification();

  const handleClick = async () => {
    await verify({ serialNumber: "ABC123" });
  };

  return (
    <div>
      <button onClick={handleClick} disabled={loading}>
        {loading ? "Verifying..." : "Verify"}
      </button>
      {result && <p>Result: {result.verified}</p>}
      {error && <p className="text-red-600">{error}</p>}
    </div>
  );
}
```

---

## Testing

### Component Tests
```typescript
// File: src/components/__tests__/DeviceCard.test.tsx
import { render, screen } from "@testing-library/react";
import { DeviceCard } from "../DeviceCard";

describe("DeviceCard", () => {
  it("displays device information", () => {
    const device = {
      id: "1",
      model: "iPhone 14",
      serialNumber: "ABC123",
    };

    render(<DeviceCard device={device} />);

    expect(screen.getByText("iPhone 14")).toBeInTheDocument();
    expect(screen.getByText("ABC123")).toBeInTheDocument();
  });
});
```

### Running Tests
```bash
bun run test
bun run test:watch
```

---

## Performance Optimization

### Code Splitting
```typescript
// ✅ Good - Lazy load pages
import { lazy, Suspense } from "react";

const VerificationPage = lazy(() => import("./pages/VerificationPage"));

export function App() {
  return (
    <Suspense fallback={<div>Loading...</div>}>
      <VerificationPage />
    </Suspense>
  );
}
```

### Memoization
```typescript
// ✅ Good - Prevent unnecessary re-renders
import { memo, useMemo } from "react";

export const DeviceCard = memo(function DeviceCard({ device }) {
  return <div>{device.model}</div>;
});

// ✅ Good - Memoize expensive calculations
export function MyComponent({ items }) {
  const total = useMemo(() => {
    return items.reduce((sum, item) => sum + item.price, 0);
  }, [items]);

  return <div>Total: {total}</div>;
}
```

### Image Optimization
```typescript
// ✅ Good - Use responsive images
<img
  src="/device.jpg"
  srcSet="/device-small.jpg 480w, /device-large.jpg 1200w"
  alt="Device"
  className="w-full"
/>
```

---

## Debugging

### Browser DevTools
```typescript
// Console logging
console.log("Value:", value);
console.error("Error:", error);

// React DevTools
// Install React DevTools browser extension
// Inspect components in Components tab

// Network tab
// Check API calls and responses
```

### Local Development
```bash
# Start with verbose logging
bun run dev -- --debug

# Check for TypeScript errors
bun run check

# Lint code
bun run lint
```

---

## Environment Variables

### Development
**File:** `frontend/.env.development`
```
VITE_CLIENT_TARGET=http://localhost:4000
```

### Production
**File:** `frontend/.env.production`
```
VITE_CLIENT_TARGET=http://localhost:4000
```
(Encore automatically resolves this during deployment)

### Using Environment Variables
```typescript
// Access in code
const apiUrl = import.meta.env.VITE_CLIENT_TARGET;

// Only variables prefixed with VITE_ are exposed to client
```

---

## Common Patterns

### Loading Data on Mount
```typescript
export function DeviceList() {
  const [devices, setDevices] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    client.verification
      .listDevices()
      .then(setDevices)
      .finally(() => setLoading(false));
  }, []);

  if (loading) return <div>Loading...</div>;

  return (
    <div>
      {devices.map((device) => (
        <DeviceCard key={device.id} device={device} />
      ))}
    </div>
  );
}
```

### Modal/Dialog Pattern
```typescript
export function VerificationModal({ isOpen, onClose }) {
  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>Verify Device</DialogTitle>
        </DialogHeader>
        <VerificationForm onSuccess={onClose} />
      </DialogContent>
    </Dialog>
  );
}
```

### Pagination Pattern
```typescript
export function DeviceList() {
  const [page, setPage] = useState(1);
  const [devices, setDevices] = useState([]);

  useEffect(() => {
    client.verification
      .listDevices({ page, limit: 10 })
      .then(setDevices);
  }, [page]);

  return (
    <div>
      {devices.map((device) => (
        <DeviceCard key={device.id} device={device} />
      ))}
      <div className="flex gap-2 mt-4">
        <Button onClick={() => setPage(p => p - 1)} disabled={page === 1}>
          Previous
        </Button>
        <span>Page {page}</span>
        <Button onClick={() => setPage(p => p + 1)}>
          Next
        </Button>
      </div>
    </div>
  );
}
```

---

## Deployment

### Before Pushing
```bash
# Type check
bun run check

# Lint
bun run lint

# Test
bun run test

# Build
bun run build
```

### After Pushing
1. GitHub Actions runs automatically
2. Encore deploys automatically
3. Check Encore dashboard
4. Test on staging

---

## Resources

- **React Documentation:** https://react.dev
- **Vite Documentation:** https://vitejs.dev
- **Tailwind CSS:** https://tailwindcss.com
- **shadcn/ui:** https://ui.shadcn.com
- **React Hook Form:** https://react-hook-form.com
- **Project Architecture:** See `PROJECT_ARCHITECTURE_REPORT.md`
- **Team Guidelines:** See `KNOWLEDGE_RULES.md`

---

**Last Updated:** January 18, 2026  
**Version:** 1.0
